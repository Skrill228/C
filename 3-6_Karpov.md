# Глава 3: Рабочие станции

## Обслуживание рабочих станций

### Три основные задачи:
1. Первоначальная установка ОС и ПО.
2. Обновление ОС и ПО.
3. Настройка сетевых параметров.

**Автоматизация этих задач:**
- Значительно упрощает работу.
- Изменяет ситуацию к лучшему.

---

## Рабочая станция
- Компьютерное оборудование для одного пользователя.
- Настольный компьютер или ноутбук.
- Компьютеры с удаленным доступом, виртуальные машины, ноутбуки с док-станциями.

---

## Жизненный цикл рабочей станции

### Основные этапы:
1. **Рождение**: первоначальная установка оборудования.
2. **Использование**: основная эксплуатация.
3. **Смерть**: вывод из эксплуатации.

### Важные аспекты:
- Правильное внесение изменений.
- Критическая важность своевременного выполнения задач.

### Модель жизненного цикла (по Реми Эварду):
#### Пять состояний:
1. **Новое**: совершенно новая машина.
2. **Чистое**: с установленной, но не настроенной ОС.
3. **Сконфигурированное**: настроенная и функционирующая система.
4. **Неизвестное**: неправильно сконфигурированная или устаревшая.
5. **Отключенное**: списанная и отключенная.

#### Переходы между состояниями:
- **Сборка и инициализация** (обычно один этап).
- **Энтропия** (амортизация, ведущая в неизвестное состояние).
- **Обновления** (патчи, пакеты обновления).
- **Восстановление** (удаление данных и переустановка).
- **Списание**.

#### Важные выводы из модели:
- Разные состояния требуют различных подходов.
- Планирование времени установки и исправлений важно.
- Основное время рабочей станции — в **сконфигурированном состоянии**.
- Процессы установки и восстановления должны быть:
  - Быстрыми.
  - Эффективными.
  - Автоматическими.
- Замедление деградации ОС критически важно.
- Найти баланс между доступом и ограничением прав пользователей.
- Автоматизация установки снижает риск ошибок.
- Хранение данных на сервере упрощает переустановку.
- Жизненный цикл требует грамотного управления.

---

## Платформы

### Определение:
Определенная комбинация поставщика оборудования и ОС.

#### Примеры:
- **AMD Athlon + Windows Vista**.
- **Intel Xeon + Ubuntu Linux**.
- **Sun Sparc + Solaris**.

### Особенности:
- Разные платформы = разные поставщики + одна ОС.
- Разные версии ОС = разные платформы (при различающихся требованиях).

---

## Установка ОС

### Автоматическая установка:
- **Примеры систем**:
  - JumpStart (Solaris).
  - KickStart (RedHat Linux).
  - Robolnst (SGI IRIX).
  - Ignite-UX (HP-UX).
  - Remote Installation Service (Microsoft Windows).

#### Преимущества:
- Решение множества проблем.
- Экономия денег и времени.
- Снижение затрат на исправление ошибок.

#### Типы автоматизации:
1. **Полностью автоматизированная система**:
   - Требует больших усилий, но окупается.
   - Не требует ручного вмешательства.
   - Пример: JumpStart (Solaris).

2. **Частично автоматизированная система**:
   - Временные меры для некоторых этапов.
   - Необходимость документирования процесса.

3. **Клонирование**:
   - Создание точной копии ПО.
   - Менее предпочтительно, чем автоматизированная установка.

---

## Обновление системного ПО и приложений

### Важность:
- Исправление ошибок и уязвимостей.
- Установка новых приложений.

### Автоматизация:
- Экономия времени и сил.
- **Примеры**:
  - AutoPatch (Solaris).
  - SMS (Microsoft Windows).

### Отличия от установки:
- Узел остается в рабочем состоянии.
- Нет необходимости в физическом доступе.
- Узел может быть в "неизвестном состоянии".
- Возможность использования узла во время обновления.

### Метод "одна, несколько, много":
- Постепенное внедрение обновлений.
- Снижение риска ошибок.

---

## Конфигурирование сети

### Автоматизация обновления сетевых параметров:
- Особенно важна для крупных сетей.
- Использование DHCP.

#### Преимущества DHCP:
- Хранение шаблонов параметров для разных классов узлов.
- Упрощение изменений и снижение риска ошибок.
- Динамическая аренда IP-адресов:
  - Удобно для пользователей.
  - Облегчает работу администраторов.

#### Недостатки:
- Серверы требуют статических адресов.
- Динамический DNS с DHCP усложняет систему.

---

## Тонкости

### Полная уверенность в процессах:
- Позволяет искать новые способы применения.
- Пример: уверенность в JumpStart привела к изменению предоставления услуг.

### Вовлечение пользователей:
- Пользователи должны участвовать в стандартизации.
- Создание соглашений об уровне обслуживания.

### Разнообразие стандартных конфигураций:
- Возможность создания нескольких конфигураций.
- Важность единой системы управления.

---

## Заключение

- Автоматизация установки ОС, обновления ПО и конфигурации сети — ключ к экономии.
- Грамотное выполнение — залог успеха.



# Глава 4: Серверы

## Основные положения

- **Надежность и бесперебойная работа** — главный приоритет для серверов, так как от них зависит множество пользователей.
- Серверы рассчитаны на более длительное время работы, чем рабочие станции, что влечет за собой дополнительные расходы.
- **Покупка сервера с избыточной мощностью** — это инвестиция в продление его срока службы.
- Серверное оборудование качественно отличается от оборудования для индивидуальных рабочих станций.
- При установке и поддержке серверов используются особые процедуры и, как правило:
  - Контракты на обслуживание.
  - Системы резервного копирования.
  - Операционные системы и возможности удаленного доступа.
- Серверы размещают в вычислительных центрах с контролируемым микроклиматом и ограниченным доступом.

---

## 4.1 Основы

### 4.1.1 Покупайте для серверов серверное оборудование

- Серверные системы отличаются от клиентских или настольных рабочих станций.
- Серверное оборудование обычно стоит дороже, но обладает:
  - **Большей расширяемостью:** больше физического пространства для жестких дисков и слотов для карт расширения, а также разъемы с высокой пропускной способностью.
  - **Большей производительностью центральных процессоров:** несколько ЦП, упреждающая выборка данных, многоступенчатая проверка, динамическое распределение ресурсов.
  - **Высокопроизводительными системами обмена информацией (ввода-вывода):** использование SCSI или FC-AL вместо IDE, высокоскоростных шин и сетевых интерфейсов.
  - **Возможностями модернизации:** серверы чаще модернизируют, чем заменяют.

#### Ключевые отличия серверного оборудования

- **Возможность добавления/замены процессоров:** серверные процессоры обычно устанавливаются на отдельных разъемах, что упрощает их замену на более производительные без необходимости замены всей материнской платы.
- **Монтирование в стойку:** серверы предназначены для установки в стандартные серверные стойки, обеспечивая эффективное использование пространства и упрощая обслуживание.
- **Отсутствие необходимости доступа с боковых сторон:** конструкция серверов предусматривает доступ ко всем компонентам с передней или задней панели, что критично для стоечного размещения.
- **Повышенная надежность:** серверы оснащаются дублирующими компонентами, такими как блоки питания, RAID-массивы, сетевые карты, что обеспечивает отказоустойчивость.
- **Контракт на обслуживание:** поставщики серверов предлагают контракты на обслуживание, гарантирующие оперативную замену компонентов и техническую поддержку.
- **Альтернативные варианты управления:** поддержка функций удаленного управления, таких как доступ через последовательный порт, встроенные датчики температуры и средства мониторинга.
- **Дистанционное управление:** критически важно для серверов, размещенных в колокейшн-центрах, позволяет минимизировать время простоя.

---

### 4.1.2 Выбирайте поставщиков, известных надежностью продукции

- Важно выбирать поставщиков с проверенной репутацией.
- Опытные поставщики обеспечивают лучший уровень обслуживания и поддержки.
- **Рекомендации:** SAGE (System Administrators’ Guild) и LOPSA (League of Professional System Administrators).
- **Однотипное оборудование:** проще в обслуживании.
- **Разнотипное оборудование:** дает большую гибкость и независимость от одного поставщика.

---

### 4.1.3 Реальные расходы на серверное оборудование

- Три серии продукции:
  - **Для дома:** минимальная начальная цена, ограниченные возможности расширения.
  - **Для бизнеса:** выше начальная цена, больший срок службы, меньшее разнообразие запасных частей.
  - **Серверное оборудование:** ориентировано на соотношение себестоимости и производительности.
- Серверы дороже в производстве, но экономичнее в долгосрочной перспективе.
- Дополнительное оборудование и компоненты с возможностью «горячей» замены окупаются за счет минимизации простоев.

---

### 4.1.4 Контракты на обслуживание и запасные компоненты

- Важно продумать, как будет происходить ремонт сервера.
- Поставщики предлагают различные варианты контрактов на обслуживание.
- **Сценарии выбора контракта:**
  - **Некритически важный сервер:** подходит контракт с обслуживанием на следующий день или вообще без контракта.
  - **Большая группа идентичных серверов:** целесообразно приобрести комплект запасных частей.
  - **Постепенная модернизация:** стандартизировать срок обеспечения запасными компонентами.
  - **Важные узлы:** запас только тех компонентов, которые чаще всего выходят из строя.
  - **Большое количество моделей от одного поставщика:** выделение техника для работы в сети компании.
  - **Критически важный узел:** выделение техника и дублирующей машины.
- Необходимо искать компромисс между хранением запасных частей и сервисным контрактом.
- Важно своевременно включать новое оборудование в контракт на обслуживание.
- Регулярно пересматривать контракт.

#### Способы не забыть оборудование:

- Система инвентаризации.
- Ответственный за закупки.
- Решение общих проблем с гарантией:
  - Наладить обмен новых компонентов на старые.
  - Лучшие поставщики осуществляют перекрестную доставку.
- Комплект запасных частей сокращает время на ремонт.

---

### 4.1.5 Обеспечение целостности данных

- На серверах хранятся критически важные данные и уникальные конфигурации.
- Данные клиентских машин обычно хранятся на серверах, что снимает необходимость в их резервном копировании.
- Необходимо резервное копирование файлов конфигураций на клиентских машинах.
- Важно зарезервировать место для размещения сервера при его приобретении.

---

### 4.1.6 Размещение серверов в вычислительном центре

- Серверы должны устанавливаться в условиях с надежным энергоснабжением, противопожарной защитой, сетью, охлаждением и физической безопасностью.
- Лучше всего зарезервировать место в стойке до установки ОС и ПО.
- Для филиалов: выделить комнату или шкаф с физической безопасностью, ИБП и охлаждением.

---

### 4.1.7 Конфигурация клиент-серверной ОС

- Серверы не обязательно должны работать под управлением тех же ОС, что и клиенты.
- Веб-серверу не нужно работать под управлением той же ОС, что и у клиентов.
- Клиенты и сервер должны использовать одинаковый протокол.

---

### 4.1.8 Обеспечьте удаленный доступ через консоль

- Для серверов необходима возможность удаленного обслуживания.
- **Переключатель KVM (клавиатура, видео, мышь):** позволяет нескольким машинам использовать одну консоль.
- **IP-KVM:** KVM без периферии, доступ через ПО.
- **Предшественник KVM:** переключатель для устройств с последовательным портом.
- Консольные концентраторы бывают самодельные и специализированные.
- Последовательные консоли и KVM позволяют управлять системой, даже если сеть не работает.
- Некоторые поставщики предоставляют карты расширения для удаленного управления.
- Удаленные консоли позволяют имитировать сочетания клавиш.
- Важно вести мониторинг всех последовательных портов.
- **Ограничения удаленного доступа:** физические задачи требуют присутствия человека.

---

### 4.1.9 Зеркалирование загрузочных дисков

- Загрузочный диск труднее всего заменить.
- Для загрузочного диска каждого сервера необходимо создать зеркальный диск (RAID 1).
- Зеркалирование повышает скорость чтения, но может замедлять запись.
- Сбой диска при зеркалировании не приводит к простою.

---

### 4.2 Тонкости

#### 4.2.1 Повышение надежности и удобства обслуживания

##### 4.2.1.1 Одноцелевые серверы

- Одноцелевое устройство предназначено для выполнения одной конкретной задачи.
- **Преимущества:**
  - Снижение количества систем, которые нужно устанавливать с нуля.
  - Поддержка от поставщика.
  - Качественно настроенные системы.
  - Наличие уникальных возможностей.

##### 4.2.1.2 Резервные блоки питания

- Серверы должны быть обеспечены резервными блоками питания (избыточность n + 1).
- У каждого блока питания должен быть отдельный кабель питания.
- **Преимущества отдельных кабелей питания:**
  - Возможность поочередного переключения без простоя.

---

##### 4.2.1.3 Полная избыточность, или n + 1

- Два полных набора оборудования объединены в отказоустойчивую конфигурацию.
- Переключение на резервные мощности вручную или автоматически.
- Другие системы с полной избыточностью используют распределение нагрузки.
- При n >= 2, n + 1 выгоднее полной избыточности.
- Важно не купить систему с избыточностью n + 1, где резервными являются только некоторые части.

---

##### 4.2.1.4 Компоненты, поддерживающие «горячую» замену

- «Горячая» замена — возможность замены компонента во время работы системы.
- **Преимущества:**
  - Возможность замены при сбоях.
- В RAID-системах диск с «горячей» заменой активируется автоматически.
- Компоненты с «горячей» заменой повышают стоимость системы.
- Важно понимать, как происходит «горячая» замена у конкретного поставщика.
- Поставщики должны указывать на ярлыках, поддерживается ли «горячая» замена.
- **Примечание:** «Горячее» подключение не равно «горячей» замене.

---

##### 4.2.1.5 Раздельные сети для административных функций

- Дополнительные сетевые интерфейсы позволяют создать раздельные административные сети (резервное копирование, мониторинг).
- **Преимущества:**
  - Отделение трафика резервного копирования от основной сети.
  - Более надежная сеть, не подверженная влиянию простоев основной сети.

---

#### 4.2.2 Альтернатива: множество недорогих серверов

- Вместо одного дорогого сервера — несколько недорогих, которые чаще дают сбои.
- Подходит для крупных веб-ферм с автоматической установкой и распределением нагрузки.
- Экономия за счет массового производства компонентов для ПК.
- Оптимизация требований к физическому оборудованию и создание эффективных конфигураций (1U-серверы).
- Пример: одноразовые серверы в 1U-корпусах.

---

## Заключение

- Серверы являются критически важным элементом ИТ-инфраструктуры, и их правильный выбор, установка и обслуживание напрямую влияют на устойчивость и эффективность бизнеса.
- Использование серверного оборудования, продуманных решений по резервному копированию, удаленному управлению и обеспечению отказоустойчивости помогает минимизировать простои и снижает затраты в долгосрочной перспективе.
- Применение модульного подхода, использование компонентов с "горячей" заменой и построение раздельных сетей для административных функций делают инфраструктуру более гибкой и устойчивой к сбоям.
- Важно заранее планировать потребности и обеспечивать поддержку серверного оборудования через контракты на обслуживание или собственные запасы комплектующих.
- Внедрение инновационных решений, таких как одноразовые серверы или распределенные системы, позволяет создавать более масштабируемые и экономичные системы, особенно для крупных веб-проектов и облачных платформ.

Соблюдение всех этих принципов позволяет создавать надежные и эффективные серверные системы, которые обеспечат бесперебойную работу всех бизнес-процессов.


# Глава 5: Сервисы

### Основные понятия
- **Сервер** — оборудование.
- **Сервис** — функция, предоставляемая сервером, может быть распределен между несколькими серверами.
- **Цель главы** — описать создание надежного и простого в обслуживании сервиса, отвечающего требованиям пользователей.

### Предоставление сервиса
1. Совмещение оборудования и программного обеспечения.
2. Обеспечение надежности, масштабируемости, мониторинга, обслуживания и поддержки.
3. **Задачи системного администратора**:
   - Постоянное предоставление необходимых пользователям сервисов.
   - Разработка и установка новых сервисов.

### Типичные сетевые сервисы
- **Основные**: DNS, электронная почта, аутентификация, подключение к сети, печать.
- **Дополнительные**: удаленный доступ, резервное копирование, DHCP, файл-сервисы.
- **Специализированные бизнес-сервисы**: бухгалтерия, производственные системы.

### Зависимость сервисов
- Многие сервисы зависят от DNS, сети и аутентификации.
- Отказ DNS вызывает каскадные сбои других сервисов.

---

## Основы создания сервиса

### Потребности пользователей
1. Выяснить нужды и ожидания.
2. Составить список административных требований.
3. Ориентироваться на **"что", а не на "как"**.

### Принципы
- **Открытые протоколы и архитектуры** — гибкость и совместимость.
- **Серверный класс машин** — надежность, быстродействие, правильные условия содержания.
- **Мониторинг**:
  - Отслеживание состояния сервиса.
  - Генерация предупреждений при сбоях.

### Взаимозависимость сервисов
- Отказ одного компонента может привести к сбоям других.

### Требования к надежности
1. Минимизировать ПО на серверах.
2. Ограничить доступ к серверным машинам.
3. Использовать стандартные конфигурации и документацию.
4. Разделение сервисов для независимости.

---

## Разработка сервиса

### Сбор требований
- Как пользователи будут применять сервис?
- Насколько важен сервис? Уровень поддержки?
- **Демонстрация** и тестирование.

### Соглашение об уровне обслуживания (SLA)
- Перечень предоставляемых сервисов.
- Категории приоритетов проблем.
- Время ответа, процесс эскалации.
- План развития сервиса.

### Технические требования
- **Интеграция** с существующими сервисами.
- **Масштабирование**:
  - Процесс обновления.
  - Производительность сети.
- **Влияние времени ожидания**:
  - Оптимизация запросов к базам данных.
  - Минимизация количества пакетов.

---

## Мониторинг и стандарты

### Мониторинг
1. Работоспособность и производительность.
2. Автоматическое оповещение о проблемах.
3. Упреждающий мониторинг.

### Открытая архитектура
- Использование открытых протоколов.
- Примеры: SMTP, Kerberos.
- Избегание проприетарных решений.

---

## Простота и надежность

### Простота
- Простое решение — более надежное.
- Сложные системы — больше ошибок, труднее поддерживать.

### Надежность
1. Использование избыточного оборудования.
2. Ограничение прямого доступа к серверам.
3. Размещение серверов в вычислительных центрах:
   - Надежное энергоснабжение.
   - Охлаждение, пожаротушение, безопасное место.

---

## Производительность и масштабирование

### Производительность
- Тестирование нагрузки: измерение пропускной способности и времени ожидания.
- Планирование мощностей с запасом.

### Масштабирование
- Разделение нагрузки.
- Использование кластеров и виртуальных IP-адресов.
- Размещение серверов в удаленных сетях.

---

## Финальный этап: разворачивание

### Основные шаги
1. Постепенное развертывание.
2. Документирование и стандарты.
3. Выделенные серверы для упрощения поддержки.

### Полная избыточность
- Дублирующие серверы.
- Синхронизация данных.
- Фермы клонированных серверов.

---

## Заключение
- **Ключевые факторы успеха**:
  - Удовлетворение потребностей пользователей.
  - Простота управления.
  - Надежность, избыточность и мониторинг.
- Влияние на мнение пользователей.


# Глава 6: Вычислительные центры

## Введение
Глава посвящена созданию вычислительного центра (ВЦ) — места, где находятся машины, предоставляющие общие ресурсы. ВЦ — это не просто комната с серверами, а сложная система, включающая охлаждение, регулировку влажности, электропитание и противопожарные системы.

---

## Основные положения
- **Надежность**: Все важные компоненты собираются в одном месте и тщательно контролируются.
- **Типы помещений**: ВЦ могут быть отдельными зданиями, переоборудованными офисами или даже небольшими «каморками».
- **Стоимость**: Создание ВЦ дорого, а правильное создание — ещё дороже. Важно обосновать затраты будущей экономией.
- **Планирование роста**: Учитывать перспективы расширения сети.
- **Аренда места**: Использование колокейшн-центров может быть экономически выгодным.
- **Долгосрочное планирование**: Проектировать ВЦ с учётом перспектив на 8–10 лет.
- **Эволюция компьютеров**: Современные серверы требуют ВЦ из-за требований к надёжности.
- **Граница между ВЦ и офисом**: Определяется функциями и требованиями, а не типом оборудования.

---

## 6.1 Основы
### 6.1.1 Размещение
- **Выбор места**: Учитывать стихийные бедствия, доступность, прокладку линий связи и электричества.
- **Резервирование**: Создание резервных подключений (различная маршрутизация, спутники).
- **Политические границы**: Регулирование может сделать размещение в другом регионе выгоднее.

### 6.1.2 Доступ
- **Физический доступ**: Ограничен для обслуживающего персонала.
- **Безопасность**: Использование бесконтактных пропусков, видеонаблюдения.
- **Перемещение оборудования**: Просторные проходы, усиленные зоны пола.

### 6.1.3 Безопасность
- **Физическая защита**: Ограничение доступа и соблюдение стандартов.
- **Ответственные лица**: Назначение ответственных за безопасность.

### 6.1.4 Электричество и охлаждение
- **Взаимосвязь**: На каждый ватт потребления требуется минимум 1 ватт на охлаждение.
- **Охлаждение**:
  - Фальшпол для подачи воздуха.
  - Подача холодного воздуха сверху.
- **Энергоснабжение**:
  - Источник бесперебойного питания (ИБП).
  - Генераторы с автоматическим включением резерва (АВР).
  - Регулярная профилактика ИБП.

### 6.1.5 Системы пожаротушения
- **Выбор системы**: Учитывать потенциальный вред для людей и оборудования.
- **Активация**: Оповещение о задымлении до активации системы.

### 6.1.6 Стойки
- **Важность**: Стойки определяют организацию пространства, охлаждение и кабельную инфраструктуру.
- **Типы**: Серверные, сетевые стойки.
- **Размеры**: Стандартные 19-дюймовые стойки, измерение в рэк-юнитах (1U = 1,75 дюйма).

### 6.1.7 Проводка
- **Планирование**: Заранее продумать укладку кабелей.
- **Маркировка**: Использование цветов и ярлыков для упрощения обслуживания.

### 6.1.8 Маркировка
- **Ярлыки**: Установка на лицевой и задней панелях устройств.
- **Синхронизация**: Идентичность информации на физических и программных ярлыках.

### 6.1.9 Связь
- **Способы связи**: Рации, мобильные и стационарные телефоны.

### 6.1.10 Консольный доступ
- **Консольные серверы**: Для удалённого доступа.
- **Переключатели KVM**: Управление несколькими машинами с одного устройства.

### 6.1.11 Рабочее место
- **Расположение**: Рядом с ВЦ, но вне его.
- **Оборудование**: Розетки, антистатические поверхности.

### 6.1.12 Инструменты и запасы
- **Запасы**: Кабели, инструменты, запасные части.
- **Хранение**: Тележки, маркированные контейнеры.

### 6.1.13 Места для хранения
- **Организация**: Удобное размещение маркированных тележек и контейнеров.

---

## 6.2 Тонкости
### 6.2.1 Повышенная избыточность
- **Резервирование**: Дублирование систем электропитания и охлаждения.
- **Стандарты**: NEBS, ETSI, SAS-70.

### 6.2.2 Больше пространства
- **Широкие проходы**: Для удобства перемещения оборудования.

---

## 6.3 Идеальные вычислительные центры
Примеры описания идеальных ВЦ с точки зрения разных специалистов.

---

## 6.4 Заключение
- **Планирование**: Учитывать множество факторов.
- **Инвестиции**: Создание надёжного ВЦ требует вложений, но они окупаются.
- **Простые решения**: Увеличивают эффективность работы.
- **Советы**: Прислушиваться к мнению системных администраторов.
- **Избыточность**: Повышает надёжность.

---

## Ключевые выводы
- Создание ВЦ — сложная задача, требующая тщательного проектирования.
- Грамотное проектирование повышает эффективность, надёжность и удобство работы.
- Даже простые решения, такие как правильная укладка кабелей и маркировка, улучшают работу ВЦ.
- Идеальный ВЦ — это не просто помещение с серверами, а сложная система, обеспечивающая бесперебойную работу оборудования.
